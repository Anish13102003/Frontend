<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Create New Planet</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#6ee7b7; --muted:#93c5fd;
      --glass: rgba(255,255,255,0.03);
      --radius:14px; --pad:18px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{margin:0; min-height:100vh; background:linear-gradient(180deg,#051025 0%, #07122b 60%); color:#e6eef8; padding:30px;}
    .wrap{max-width:1100px; margin:0 auto; display:grid; grid-template-columns:1fr 420px; gap:22px; align-items:start}
    header{grid-column:1/-1; display:flex; justify-content:space-between; align-items:center; margin-bottom:6px}
    h1{font-size:20px; margin:0}
    .sub{color:rgba(230,238,248,0.7); font-size:13px}

    form{background:var(--card); padding:var(--pad); border-radius:var(--radius); box-shadow:0 4px 30px rgba(4,6,12,0.6);}
    label{display:block; font-size:13px; margin-top:12px}
    input[type=text], input[type=number], textarea, select{width:100%; padding:10px 12px; margin-top:8px; border-radius:10px; border:1px solid rgba(255,255,255,0.06); background:var(--glass); color:inherit; font-size:14px}
    textarea{min-height:90px; resize:vertical}
    .row{display:flex; gap:12px}
    .col{flex:1}
    .muted{color:rgba(230,238,248,0.65); font-size:13px}
    .small{font-size:12px}

    .list-box{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent); padding:12px; border-radius:10px; margin-top:10px}
    .chip{display:inline-flex; gap:8px; align-items:center; padding:8px 10px; border-radius:999px; margin:6px 6px 0 0; background:rgba(255,255,255,0.03); font-size:13px}
    button{cursor:pointer; border:0; padding:10px 12px; border-radius:10px; background:var(--accent); color:#012; font-weight:600}
    .btn-ghost{background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--muted)}
    .controls{display:flex; gap:8px; margin-top:14px}

    /* Preview column */
    .preview{background:linear-gradient(180deg,#061226 0%, #051026 60%); padding:var(--pad); border-radius:var(--radius); height:100%}
    .planet-card{border-radius:12px; padding:16px; background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);}
    .planet-name{font-size:20px; font-weight:700}
    .meta{display:flex; gap:12px; margin-top:12px; align-items:center}
    .currency{padding:8px 10px; border-radius:10px; background:rgba(255,255,255,0.03)}
    ul{padding-left:18px}

    footer{grid-column:1/-1; margin-top:14px; color:rgba(230,238,248,0.6); font-size:13px}

    @media (max-width:980px){.wrap{grid-template-columns:1fr;}.preview{order:2}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Create a New Planet</h1>
        <div class="sub">Design the planet, currency, rules and inhabitants — preview and export as JSON.</div>
      </div>
      <div class="muted small">Tip: add people & rules, then click <strong>Export JSON</strong>.</div>
    </header>

    <form id="planetForm" autocomplete="off">
      <label for="name">Planet name</label>
      <input id="name" name="name" type="text" placeholder="e.g. Aurelia" required />

      <div class="row">
        <div class="col">
          <label for="system">Star system</label>
          <input id="system" name="system" type="text" placeholder="e.g. Trappist-7" />
        </div>
        <div class="col">
          <label for="size">Size (km radius)</label>
          <input id="size" name="size" type="number" min="1" placeholder="e.g. 6371" />
        </div>
      </div>

      <hr style="border:none;margin:14px 0;border-top:1px solid rgba(255,255,255,0.03)">

      <label>Currency</label>
      <div class="row">
        <div class="col">
          <input id="currencyName" placeholder="Currency name (e.g. Solari)" />
        </div>
        <div style="width:120px">
          <input id="currencySymbol" placeholder="Symbol (e.g. \u20B9, ₿, S)" />
        </div>
      </div>
      <label for="exrate" class="small muted">Exchange rate to Earth credit (1 unit = ? Earth credits)</label>
      <input id="exrate" type="number" step="0.0001" placeholder="e.g. 0.86" />

      <label style="margin-top:12px">Rules (laws, customs)</label>
      <div class="list-box">
        <div style="display:flex; gap:8px">
          <input id="ruleInput" placeholder="Add a rule (press enter or +)" />
          <button type="button" id="addRule">+</button>
        </div>
        <div id="rulesList" style="margin-top:10px"></div>
      </div>

      <label style="margin-top:12px">People (leaders, citizens)</label>
      <div class="list-box">
        <div class="row">
          <input id="personName" placeholder="Name" class="col" />
          <input id="personRole" placeholder="Role (e.g. Governor)" style="width:160px" />
          <button type="button" id="addPerson">Add</button>
        </div>
        <div id="peopleList" style="margin-top:10px"></div>
      </div>

      <label style="margin-top:12px">Notes / Description</label>
      <textarea id="desc" placeholder="Short description about the planet, culture, climate..."></textarea>

      <div class="controls">
        <button type="button" id="previewBtn">Update Preview</button>
        <button type="button" id="saveLocal" class="btn-ghost">Save to local</button>
        <button type="button" id="exportJSON" class="btn-ghost">Export JSON</button>
        <button type="reset" id="resetBtn" class="btn-ghost">Reset</button>
      </div>
    </form>

    <aside class="preview">
      <div class="planet-card" id="previewCard">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div class="planet-name" id="pvName">—</div>
            <div class="sub muted" id="pvSystem">Star system —</div>
          </div>
          <div style="text-align:right">
            <div class="currency" id="pvCurrency">—</div>
            <div class="muted small" id="pvSize">Size —</div>
          </div>
        </div>

        <div style="margin-top:12px">
          <strong>Rules & Laws</strong>
          <div id="pvRules" style="margin-top:8px" class="muted">No rules yet.</div>
        </div>

        <div style="margin-top:12px">
          <strong>People</strong>
          <div id="pvPeople" style="margin-top:8px" class="muted">No people added.</div>
        </div>

        <div style="margin-top:12px">
          <strong>Description</strong>
          <div id="pvDesc" class="muted" style="margin-top:8px">—</div>
        </div>
      </div>
    </aside>

    <footer>
      Built for rapid prototyping — you can copy the exported JSON to share your planet. Data is stored locally in your browser only when you click "Save to local".
    </footer>
  </div>

  <script>
    // Utility state
    const rules = [];
    const people = [];

    // Elements
    const ruleInput = document.getElementById('ruleInput');
    const addRuleBtn = document.getElementById('addRule');
    const rulesList = document.getElementById('rulesList');

    const personName = document.getElementById('personName');
    const personRole = document.getElementById('personRole');
    const addPersonBtn = document.getElementById('addPerson');
    const peopleList = document.getElementById('peopleList');

    // Preview elements
    const pvName = document.getElementById('pvName');
    const pvSystem = document.getElementById('pvSystem');
    const pvCurrency = document.getElementById('pvCurrency');
    const pvSize = document.getElementById('pvSize');
    const pvRules = document.getElementById('pvRules');
    const pvPeople = document.getElementById('pvPeople');
    const pvDesc = document.getElementById('pvDesc');

    function renderRules(){
      rulesList.innerHTML = '';
      if(rules.length === 0){ rulesList.innerHTML = '<div class="muted small">No rules yet.</div>'; return }
      rules.forEach((r, idx)=>{
        const chip = document.createElement('div'); chip.className='chip';
        chip.textContent = r;
        const del = document.createElement('button'); del.textContent='✕'; del.style.background='transparent'; del.style.border='0'; del.style.cursor='pointer'; del.style.marginLeft='8px'; del.onclick = ()=>{ rules.splice(idx,1); renderRules(); renderPreview(); };
        chip.appendChild(del);
        rulesList.appendChild(chip);
      });
    }

    function renderPeople(){
      peopleList.innerHTML = '';
      if(people.length === 0){ peopleList.innerHTML = '<div class="muted small">No people yet.</div>'; return }
      people.forEach((p, idx)=>{
        const chip = document.createElement('div'); chip.className='chip';
        chip.innerHTML = `<strong>${escapeHtml(p.name)}</strong> <span style="opacity:.7; margin-left:8px">${escapeHtml(p.role)}</span>`;
        const del = document.createElement('button'); del.textContent='✕'; del.style.background='transparent'; del.style.border='0'; del.style.cursor='pointer'; del.style.marginLeft='8px'; del.onclick = ()=>{ people.splice(idx,1); renderPeople(); renderPreview(); };
        chip.appendChild(del);
        peopleList.appendChild(chip);
      });
    }

    addRuleBtn.addEventListener('click', ()=>{ const v = ruleInput.value.trim(); if(!v) return; rules.push(v); ruleInput.value=''; renderRules(); renderPreview(); });
    ruleInput.addEventListener('keydown', (e)=>{ if(e.key === 'Enter'){ e.preventDefault(); addRuleBtn.click(); } });

    addPersonBtn.addEventListener('click', ()=>{
      const n = personName.value.trim(); const r = personRole.value.trim(); if(!n) return; people.push({name:n, role: r || 'Citizen'}); personName.value=''; personRole.value=''; renderPeople(); renderPreview();
    });

    document.getElementById('previewBtn').addEventListener('click', renderPreview);

    document.getElementById('exportJSON').addEventListener('click', ()=>{
      const data = gatherData();
      const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = (data.name || 'planet') + '.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    document.getElementById('saveLocal').addEventListener('click', ()=>{
      const data = gatherData(); if(!data.name){ alert('Give the planet a name before saving.'); return }
      localStorage.setItem('planet_' + data.name, JSON.stringify(data)); alert('Saved locally under key: planet_' + data.name);
    });

    document.getElementById('resetBtn').addEventListener('click', ()=>{
      rules.length = 0; people.length = 0; renderPeople(); renderRules(); setTimeout(renderPreview, 60);
    });

    function gatherData(){
      return {
        name: document.getElementById('name').value.trim(),
        system: document.getElementById('system').value.trim(),
        size_km_radius: Number(document.getElementById('size').value) || null,
        currency: { name: document.getElementById('currencyName').value.trim() || null, symbol: document.getElementById('currencySymbol').value.trim() || null, exchange_to_earth_credit: Number(document.getElementById('exrate').value) || null },
        rules: rules.slice(),
        people: people.slice(),
        description: document.getElementById('desc').value.trim()
      };
    }

    function renderPreview(){
      const d = gatherData();
      pvName.textContent = d.name || 'Unnamed Planet';
      pvSystem.textContent = d.system ? `System: ${d.system}` : 'System —';
      pvCurrency.textContent = d.currency.name ? `${d.currency.name} ${d.currency.symbol || ''}` : 'Currency —';
      pvSize.textContent = d.size_km_radius ? `Radius ${d.size_km_radius} km` : 'Size —';
      pvRules.innerHTML = d.rules && d.rules.length ? `<ul>${d.rules.map(r=>`<li>${escapeHtml(r)}</li>`).join('')}</ul>` : '<div class="muted small">No rules yet.</div>';
      pvPeople.innerHTML = d.people && d.people.length ? `<ul>${d.people.map(p=>`<li><strong>${escapeHtml(p.name)}</strong> — ${escapeHtml(p.role || 'Citizen')}</li>`).join('')}</ul>` : '<div class="muted small">No people yet.</div>';
      pvDesc.textContent = d.description || '—';
    }

    // small escape to avoid HTML injection for preview
    function escapeHtml(s){ return (s+'').replace(/[&<>"']/g, function(c){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c]; }); }

    // Initialize
    renderRules(); renderPeople(); renderPreview();

    // load example if you want
    (function seed(){
      // sample data — comment out if undesired
      document.getElementById('name').value = 'Aurelia';
      document.getElementById('system').value = 'Trappist-7';
      document.getElementById('size').value = 9800;
      document.getElementById('currencyName').value = 'Aurelian';
      document.getElementById('currencySymbol').value = 'Æ';
      document.getElementById('exrate').value = 1.23;
      rules.push('No weapons within city borders');
      rules.push('Weekly market day on Sol 3');
      people.push({name:'Governor Lys', role:'Governor'});
      people.push({name:'Dr. Miri', role:'Chief Scientist'});
      document.getElementById('desc').value = 'A verdant world with floating gardens and a strong artisan culture.';
      renderPeople(); renderRules(); renderPreview();
    })();
  </script>
</body>
</html>
